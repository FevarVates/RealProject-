@page "/"

@using Microsoft.AspNetCore.Components
@implements IDisposable
@inject NavigationManager Navigation
@rendermode InteractiveServer

<div class="main-container">
    <!-- –®–∞–ø–∫–∞ -->
    <header class="header">
        <nav class="nav-container">
            <div class="nav-logo">
                <h1>Creative Duo Studio</h1>
            </div>
            <div class="nav-links">
                <NavLink href="/blog" class="nav-link">–ë–ª–æ–≥</NavLink>
                <NavLink href="/about" class="nav-link">–û –Ω–∞—Å</NavLink>
                <NavLink href="/calculator" class="nav-link">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</NavLink>
                <NavLink href="/faq" class="nav-link">FAQ</NavLink>
                <NavLink href="/faq" class="nav-link">–Ø–∑—ã–∫</NavLink>
            </div>
        </nav>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="content-wrapper">
        <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å - –ë—Ä–∞—Ç -->
        <div class="half-section left-section"
             @onmouseover="@(() => SetActiveSection("left"))"
             @onmouseout="@(() => SetActiveSection(null))"
             style="@GetLeftSectionStyle()">
            
            <div class="section-content">
                <div class="person-title">
                    <h2 class="person-name">–ê—Ä—Å–µ–Ω–∏–π</h2>
                    <p class="person-role">–ó–≤—É–∫–æ—Ä–µ–∂–∏—Å—Å—ë—Ä & –ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä</p>
                </div>
                
                <div class="services-list">
                    <div class="service-item">
                        <span class="service-icon">üéöÔ∏è</span>
                        <span class="service-text">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —á–∏—Å—Ç–∫–∞ –∑–≤—É–∫–∞</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üìù</span>
                        <span class="service-text">–ù–∞–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üåê</span>
                        <span class="service-text">–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üéµ</span>
                        <span class="service-text">–°–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ—Ç—Ä–µ–∫–æ–≤</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üéôÔ∏è</span>
                        <span class="service-text">–ó–≤—É–∫–æ–≤–æ–π –¥–∏–∑–∞–π–Ω</span>
                    </div>
                </div>
                
                <div class="contact-button">
                    <button class="btn-primary" @onclick="NavigateToService">
                        –í—ã–±—Ä–∞—Ç—å —ç—Ç—É —Å—Ç–æ—Ä–æ–Ω—É
                    </button>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - –°–µ—Å—Ç—Ä–∞ -->
        <div class="half-section right-section"
             @onmouseover="@(() => SetActiveSection("right"))"
             @onmouseout="@(() => SetActiveSection(null))"
             style="@GetRightSectionStyle()">
            
            <div class="section-content">
                <div class="person-title">
                    <h2 class="person-name">–ò—Ä–∏–Ω–∞</h2>
                    <p class="person-role">–î–∏–∑–∞–π–Ω–µ—Ä & –ê–Ω–∏–º–∞—Ç–æ—Ä</p>
                </div>
                
                <div class="services-list">
                    <div class="service-item">
                        <span class="service-icon">üé®</span>
                        <span class="service-text">–ú–æ—É—à–Ω-–¥–∏–∑–∞–π–Ω</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">‚ú®</span>
                        <span class="service-text">–ú–æ—Ä—Ñ–∏–Ω–≥ –≤ –≤–∏–¥–µ–æ</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üñºÔ∏è</span>
                        <span class="service-text">–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–≤—å—é</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üé¨</span>
                        <span class="service-text">–†–∞–±–æ—Ç–∞ —Å –≤–∏–¥–µ–æ—Ä—è–¥–æ–º</span>
                    </div>
                    <div class="service-item">
                        <span class="service-icon">üìä</span>
                        <span class="service-text">–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞–Ω–∏–º–∞—Ü–∏—è</span>
                    </div>
                </div>
                
                <div class="contact-button">
                    <button class="btn-primary" @onclick="NavigateToService">
                        –í—ã–±—Ä–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private string? activeSection;
    private Timer? animationTimer;
    private double leftWidth = 50;
    private double rightWidth = 50;

    protected override void OnInitialized()
    {
        // –¢–∞–π–º–µ—Ä –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
        animationTimer = new Timer(_ =>
        {
            UpdateWidths();
            InvokeAsync(StateHasChanged);
        }, null, 0, 16); // ~60 FPS
    }

    private void SetActiveSection(string? section)
    {
        activeSection = section;
    }

    private void UpdateWidths()
    {
        if (activeSection == "left")
        {
            leftWidth = Math.Min(leftWidth + 2, 70);
            rightWidth = 100 - leftWidth;
        }
        else if (activeSection == "right")
        {
            rightWidth = Math.Min(rightWidth + 2, 70);
            leftWidth = 100 - rightWidth;
        }
        else
        {
            // –ü–ª–∞–≤–Ω–æ–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
            if (Math.Abs(leftWidth - 50) > 0.5)
            {
                leftWidth += (50 - leftWidth) * 0.1;
                rightWidth = 100 - leftWidth;
            }
            else
            {
                leftWidth = 50;
                rightWidth = 50;
            }
        }
    }

    private string GetLeftSectionStyle()
    {
        return $"width: {leftWidth}%;";
    }

    private string GetRightSectionStyle()
    {
        return $"width: {rightWidth}%;";
    }

    private void NavigateToCalculator()
    {
        NavigationManager.NavigateTo("/calculator");
    }
    private void NavigateToAbout()
    {
        NavigationManager.NavigateTo("/about");
    }
    private void NavigateToService()
    {
        NavigationManager.NavigateTo("/service");
    }

    [Inject]
    private NavigationManager NavigationManager { get; set; } = default!;

    public void Dispose()
    {
        animationTimer?.Dispose();
    }
}
